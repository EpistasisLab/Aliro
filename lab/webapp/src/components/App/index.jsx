/* ~This file is part of the Aliro library~

Copyright (C) 2023 Epistasis Lab, Cedars-Sinai Medical Center

Aliro is maintained by:
    - Jun Choi (hyunjun.choi@cshs.org)
    - Miguel Hernandez (miguel.e.hernandez@cshs.org)
    - Nick Matsumoto (nicholas.matsumoto@cshs.org)
    - Jay Moran (jay.moran@cshs.org)
    - and many other generous open source contributors

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <https://www.gnu.org/licenses/>.

(Autogenerated header, do not modify)

*/
import React, { Component } from 'react';
import { connect } from 'react-redux';
import * as actions from 'data/preferences/actions';
import Navbar from './Navbar';
import FetchError from '../FetchError';
import { Container, Loader } from 'semantic-ui-react';



/**
* Main menu bar of website - parent component of navbar
*/
class App extends Component {
  /**
  * react lifecycle method, when component is done loading, after it is mounted in
  * DOM, use preferences action creator, fetchPreferences, to request retrieval of
  * user preferences - user info and available machine learning algorithms
  */

   constructor(props) {
    super(props);
    this.state = this.initState;
    // this.tooltipAppFunction = this.tooltipAppFunction.bind(this);
    this.tooltipAppFunction_with_setInterval = this.tooltipAppFunction_with_setInterval.bind(this);
    this.cleanOtherTooltipFunction = this.cleanOtherTooltipFunction.bind(this);
   }

   

   

  // tooltipAppFunction() {
  // console.log("Fron app test");
  // document.addEventListener("DOMContentLoaded", function(e) {

  //   // console.log("App loaded")
  //   const x = document.getElementById("app");
  //   // find any elements with the tag name "a" with Hello Add new"
  //   const y = x.getElementsByTagName("a");
  
  //   // show content of the first element with the tag name "a"
  //   // y.
  //   // if y lentgh is 0, then wait for 1 second and try again
  //   if (y.length == 0) {
  //     setTimeout(function() {
      
  
  //       // original code
  //       // .tooltip {
  //       //   position: relative;
  //       //   display: inline-block;
  //       //   border-bottom: 1px dotted black;
  //       // }
        
  //       // .tooltip .tooltiptext {
  //       //   visibility: visible;
  //       //   width: 120px;
  //       //   background-color: #555;
  //       //   color: #fff;
  //       //   text-align: center;
  //       //   border-radius: 6px;
  //       //   padding: 5px 0;
  //       //   position: absolute;
  //       //   z-index: 1;
  //       //   bottom: 125%;
  //       //   left: 50%;
  //       //   margin-left: -60px;
  //       //   opacity: 1;
  //       //   transition: opacity 0.3s;
  //       // }
        
  //       // .tooltip .tooltiptext::after {
  //       //   visibility: visible;
  //       //   content: "";
  //       //   position: absolute;
  //       //   top: 100%;
  //       //   left: 50%;
  //       //   margin-left: -5px;
  //       //   border-width: 5px;
  //       //   border-style: solid;
  //       //   border-color: #555 transparent transparent transparent;
  //       // }
        
  //       // .tooltip:hover .tooltiptext {
  //       //   visibility: hidden;
  //       //   opacity: 1;
  //       // }
  
        
  
  //     var styles = `
  //     .tooltip {
  //       position: relative;
  //       display: inline-block;
  //       border-bottom: 1px dotted black;
  //     }
      
  //     .tooltip .tooltiptext {
  //       visibility: visible;
  //       width: 120px;
  //       background-color: #555;
  //       color: #fff;
  //       text-align: center;
  //       border-radius: 6px;
  //       padding: 5px 0;
  //       position: absolute;
  //       z-index: 1;
  //       bottom: 15%;
  //       left: 110%;
  //       margin-left: 0px;
  //       opacity: 1;
  //       transition: opacity 0.3s;
  //     }
      
  //     .tooltip .tooltiptext::after {
  //       content: "";
  //       position: absolute;
  //       top: 30%;
  //       left: -8.3%;
  //       margin-left: 0px;
  //       border-width: 5px;
  //       border-style: solid;
  //       border-color: transparent #555 transparent transparent;
  //     }
      
  //     .tooltip:hover .tooltiptext {
  //       visibility: hidden;
  //       opacity: 0;
  // `
  
      
  
  //     // visibility: visible;
  //     // width: 120px;
  //     // background-color: #555;
  //     // color: #fff;
  //     // text-align: center;
  //     // border-radius: 6px;
  //     // padding: 5px 0;
  //     // position: absolute;
  //     // z-index: 1;
  //     // bottom: 50%;
  //     // left: 100%;
  //     // margin-left: 0px;
  //     // opacity: 1;
  //     // transition: opacity 0.3s;
  
  //     // check there is no style tag already
  //     if (document.getElementsByTagName("style") == null) {
        
  //       var styleSheet = document.createElement("style")
  //       styleSheet.innerText = styles
  //       document.head.appendChild(styleSheet)
  
      
  //     }
      
  //     // <div class="tooltip">Hover over me
  //         // <span class="tooltiptext">Tooltip text</span>
  //     // </div>
  
  //     // create a div with class tooltip and html content "Hover over me"
  //     var div_test = document.createElement("div");
  //     div_test.id = "div_test";
  //     div_test.className = "tooltip";
  //     // div_test.innerHTML = "Hover over me";
  //     div_test.innerHTML = "_";
  //     // background color is white
  //     div_test.style.backgroundColor = "white";
  //     // do not show div_test
  //     // div_test.style.display = "none";
  
  //     // create a span with class tooltiptext and html content "Tooltip text"
  //     var span_test = document.createElement("span");
  //     span_test.className = "tooltiptext";
  //     span_test.innerHTML = "Step 1: add new data";
  
  //     // make span_test always visible
  //     span_test.style.visibility = "visible";
  
   
      
   
      
  
  
  
  
     
  
  
  
  
  //     // locate the span_test right of the div_test
  //     // span_test.style.left = "100%";
  //     // span_test.style.top = "0";
  //     // span_test.style.marginLeft = "5px";
  //     // span_test.style.marginTop = "-5px";
  
  
  //     // make span_test always block whever div_test is hovered or not
  //     span_test.style.display = "block";
      
  
  //     // append span_test to div_test
  //     div_test.appendChild(span_test);
  
  
  //     // append div_test to app
  //     // document.getElementById("app").appendChild(div_test);
  
  
  
  //     // real version
  //     const x = document.getElementById("app");
  //     // find any elements with the tag name "a" with Hello Add new"
  //     const y = x.getElementsByTagName("a");
  //     // add mouse over event to the div
  
  //     // append div_test to y[4]
  //     // y[4].appendChild(div_test);
      
  //     // add the class tooltip to y[4] with current y[4] class
  //     y[4].className = y[4].className + " tooltip";
  //     y[4].appendChild(span_test);
  
  //     // make current y[4] div_test's chileder
  //     // div_test.append(y[4]);
  
  //       // if y[4] is clicked, then hidden the span_test
  //       y[4].onclick = function() {
  //       span_test.style.visibility = "hidden";
  //     }
  
  
  
  
      
  
  
  //   }, 1000);
  //   } 
  //   // else {
  //   //   console.log(y);
  //   //   // add mouse over event to the div
  //   //   y.onmouseover = function() {
  //   //     console.log("mouse over");
  //   //     // change html content
  //   //     y[4].innerHTML = "Hey";
  //   //   };
  //   // }
  // });
  // }



  removeUser() {
    // if element id user_item is shown then make it hidden
    // as soon as the
    
    // show current machine os
    console.log('process.platfor',process.platform);
    console.log("current os is " + this.os);
    console.log("window.navigator.platform",window.navigator.platform);
    console.log("window.navigator.oscpu",window.navigator.oscpu);
  //   setTimeout(function() {

  //  document.getElementById("user_item").style.visibility = "hidden";
  //   }, 1000);



  }



  tooltipAppFunction_with_setInterval() {
    var flag_remove=0;
    // set interval
    setInterval(() => {

    

      // console.log("App loaded")
    const x = document.getElementById("app");
    // find any elements with the tag name "a" with Hello Add new"
    const y = x.getElementsByTagName("a");

    // check whehter div_test is already created


    // current href
    const current_href = window.location.href;
    
    // console.log("tooltipAppFunction_with_setInterval this is y: ", y);
    if (y.length > 0 && document.getElementById("span_test") == null && current_href.includes("upload_")==false) {
      // add mouse over event to the div

      console.log("inside!!!")


      var styles_v1 = `
      .tooltip {
        position: relative;
        display: inline-block;
        border-bottom: 1px dotted black;
      }
      
      .tooltip .tooltiptext {
        visibility: visible;
        width: 120px;
        background-color: #555;
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 5px 0;
        position: absolute;
        z-index: 1;
        bottom: -40%;
        left: 110%;
        margin-left: 0px;
        opacity: 1;
        transition: opacity 0.3s;
      }
      
      .tooltip .tooltiptext::after {
        content: "";
        position: absolute;
        top: 30%;
        left: -8.3%;
        margin-left: 0px;
        border-width: 5px;
        border-style: solid;
        border-color: transparent #555 transparent transparent;
      }
      
      .tooltip:hover .tooltiptext {
        visibility: hidden;
        opacity: 0;
  `
  

    if (document.getElementsByTagName("style").length == 0) {
      
      var styleSheet = document.createElement("style")
      styleSheet.innerText = styles_v1
      document.head.appendChild(styleSheet)
    
    }

    else {

      var elem = document.getElementsByTagName("style");
      elem[0].parentNode.removeChild(elem[0]);

      var styleSheet = document.createElement("style")
        styleSheet.innerText = styles_v1
        document.head.appendChild(styleSheet)
    
    
    }
  
      // <div class="tooltip">Hover over me
          // <span class="tooltiptext">Tooltip text</span>
      // </div>
  
      // create a div with class tooltip and html content "Hover over me"
      var div_test = document.createElement("div");
      div_test.id = "div_test";
      div_test.className = "tooltip";
      // div_test.innerHTML = "Hover over me";
      div_test.innerHTML = "_";
      // background color is white
      div_test.style.backgroundColor = "white";
      // do not show div_test
      // div_test.style.display = "none";
  
      // create a span with class tooltiptext and html content "Tooltip text"
      var span_test = document.createElement("span");
      span_test.id = "span_test";
      span_test.className = "tooltiptext";
      span_test.innerHTML = "Step 1: click this button and add your data.";
  
      // make span_test always visible
      if (flag_remove==0)
      {

         span_test.style.visibility = "visible";
  
      }

      if (flag_remove==1)
      {
        span_test.style.visibility = "hidden";
      }
      
   
      
  
  
  
  
     
  
  
  
  
      // locate the span_test right of the div_test
      // span_test.style.left = "100%";
      // span_test.style.top = "0";
      // span_test.style.marginLeft = "5px";
      // span_test.style.marginTop = "-5px";
  
  
      // make span_test always block whever div_test is hovered or not
      if (flag_remove==0)
      {
        span_test.style.display = "block";
      }
  
      if (flag_remove==1)
      {
        span_test.style.display = "none";
      }
      
      // append span_test to div_test
      div_test.appendChild(span_test);
  
  
      // append div_test to app
      // document.getElementById("app").appendChild(div_test);
  
  
  
      // real version
      const x = document.getElementById("app");
      // find any elements with the tag name "a" with Hello Add new"
      const y = x.getElementsByTagName("a");

  


      if (y[4].className.indexOf("tooltip") == -1) {

        y[4].className = y[4].className + " tooltip";
        y[4].appendChild(span_test);
      }
      // make current y[4] div_test's chileder
      // div_test.append(y[4]);
  
        // if y[4] is clicked, then hidden the span_test

      

      console.log("flag_remove: ", flag_remove);


      y[4].onclick = function() {
        span_test.style.visibility = "hidden";
        span_test.style.display = "block";
        console.log("clicked")
        flag_remove=1;


        

      }

















        


    };





    }, 500);
    
  }




  cleanOtherTooltipFunction() {
    console.log("Fron app test");

    if (document.getElementById("div_tooltip_file_upload")!=null && current_href.includes("upload_") == false) {
     
     
      // make hidden 
      document.getElementById("div_tooltip_file_upload").style.visibility = "hidden";

      
      // remove span_test
      document.getElementById("span_test").style.visibility = "hidden";
      
      
    }

    

    var interval = setInterval(function() {

      // if there is span id with span_upload_dataset then make it not visible
      // current href
      var current_href = window.location.href;
      // current href does not include upload_
      // if (current_href.includes("upload_") == false) 
      if (document.getElementById("div_tooltip_file_upload")!=null && current_href.includes("upload_") == false) {
       

         // console.log("div_tooltip_file_upload exists and this is not upload_dataset page");

        // remove only the div_tooltip_file_upload 
        var elem_fir = document.getElementById("div_tooltip_file_upload");
        elem_fir.parentNode.removeChild(elem_fir);

        // remove span_test
        var elem_Sec = document.getElementById("span_test");
        if (elem_Sec != null) {
          elem_Sec.parentNode.removeChild(elem_Sec);
        }

        
      }


    }, 500);

  }



  get initState() {
    // this.cleanOtherTooltipFunction();
    
  
    // this.tooltipAppFunction_with_setInterval();

    this.removeUser()

    

  }
  

  componentDidMount() {
    this.props.fetchPreferences();
  }

  render() {
    const { preferences, fetchPreferences, children } = this.props;

    if(preferences.isFetching) {
      return (
        <Loader active inverted size="large" content="Retrieving your preferences..." />
      );
    }

    if(preferences.error) {
      return (
        <FetchError
          message={preferences.error}
          onRetry={() => fetchPreferences()}
        />
      );
    }



    


    return (
      <Container fluid className="app pennai">
        <Navbar preferences={preferences.data} />
        {children}


        


        

      </Container>
      

    );
  }
}

const mapStateToProps = (state) => ({
  preferences: state.preferences
});

export { App };
export default connect(mapStateToProps, actions)(App);




//   // console.log("App loaded")
//   const x = document.getElementById("app");
//   // find any elements with the tag name "a" with Hello Add new"
//   const y = x.getElementsByTagName("a");

//   // show content of the first element with the tag name "a"
//   // y.
//   // if y lentgh is 0, then wait for 1 second and try again
//   if (y.length == 0) {
//     setTimeout(function() {
    

//       // original code
//       // .tooltip {
//       //   position: relative;
//       //   display: inline-block;
//       //   border-bottom: 1px dotted black;
//       // }
      
//       // .tooltip .tooltiptext {
//       //   visibility: visible;
//       //   width: 120px;
//       //   background-color: #555;
//       //   color: #fff;
//       //   text-align: center;
//       //   border-radius: 6px;
//       //   padding: 5px 0;
//       //   position: absolute;
//       //   z-index: 1;
//       //   bottom: 125%;
//       //   left: 50%;
//       //   margin-left: -60px;
//       //   opacity: 1;
//       //   transition: opacity 0.3s;
//       // }
      
//       // .tooltip .tooltiptext::after {
//       //   visibility: visible;
//       //   content: "";
//       //   position: absolute;
//       //   top: 100%;
//       //   left: 50%;
//       //   margin-left: -5px;
//       //   border-width: 5px;
//       //   border-style: solid;
//       //   border-color: #555 transparent transparent transparent;
//       // }
      
//       // .tooltip:hover .tooltiptext {
//       //   visibility: hidden;
//       //   opacity: 1;
//       // }

      

//     var styles = `
//     .tooltip {
//       position: relative;
//       display: inline-block;
//       border-bottom: 1px dotted black;
//     }
    
//     .tooltip .tooltiptext {
//       visibility: visible;
//       width: 120px;
//       background-color: #555;
//       color: #fff;
//       text-align: center;
//       border-radius: 6px;
//       padding: 5px 0;
//       position: absolute;
//       z-index: 1;
//       bottom: 15%;
//       left: 110%;
//       margin-left: 0px;
//       opacity: 1;
//       transition: opacity 0.3s;
//     }
    
//     .tooltip .tooltiptext::after {
//       content: "";
//       position: absolute;
//       top: 30%;
//       left: -8.3%;
//       margin-left: 0px;
//       border-width: 5px;
//       border-style: solid;
//       border-color: transparent #555 transparent transparent;
//     }
    
//     .tooltip:hover .tooltiptext {
//       visibility: hidden;
//       opacity: 0;
// `

    

//     // visibility: visible;
//     // width: 120px;
//     // background-color: #555;
//     // color: #fff;
//     // text-align: center;
//     // border-radius: 6px;
//     // padding: 5px 0;
//     // position: absolute;
//     // z-index: 1;
//     // bottom: 50%;
//     // left: 100%;
//     // margin-left: 0px;
//     // opacity: 1;
//     // transition: opacity 0.3s;

//     var styleSheet = document.createElement("style")
//     styleSheet.innerText = styles
//     document.head.appendChild(styleSheet)

//     // <div class="tooltip">Hover over me
//         // <span class="tooltiptext">Tooltip text</span>
//     // </div>

//     // create a div with class tooltip and html content "Hover over me"
//     var div_test = document.createElement("div");
//     div_test.className = "tooltip";
//     // div_test.innerHTML = "Hover over me";
//     div_test.innerHTML = "_";
//     // background color is white
//     div_test.style.backgroundColor = "white";
//     // do not show div_test
//     // div_test.style.display = "none";

//     // create a span with class tooltiptext and html content "Tooltip text"
//     var span_test = document.createElement("span");
//     span_test.className = "tooltiptext";
//     span_test.innerHTML = "step 1: add new data";

//     // make span_test always visible
//     span_test.style.visibility = "visible";

 
    
 
    




   




//     // locate the span_test right of the div_test
//     // span_test.style.left = "100%";
//     // span_test.style.top = "0";
//     // span_test.style.marginLeft = "5px";
//     // span_test.style.marginTop = "-5px";


//     // make span_test always block whever div_test is hovered or not
//     span_test.style.display = "block";
    

//     // append span_test to div_test
//     div_test.appendChild(span_test);


//     // append div_test to app
//     // document.getElementById("app").appendChild(div_test);



//     // real version
//     const x = document.getElementById("app");
//     // find any elements with the tag name "a" with Hello Add new"
//     const y = x.getElementsByTagName("a");
//     // add mouse over event to the div

//     // append div_test to y[4]
//     // y[4].appendChild(div_test);
    
//     // add the class tooltip to y[4] with current y[4] class
//     y[4].className = y[4].className + " tooltip";
//     y[4].appendChild(span_test);

//     // make current y[4] div_test's chileder
//     // div_test.append(y[4]);

//       // if y[4] is clicked, then hidden the span_test
//       y[4].onclick = function() {
//       span_test.style.visibility = "hidden";
//     }




    


//   }, 1000);
//   } 
//   // else {
//   //   console.log(y);
//   //   // add mouse over event to the div
//   //   y.onmouseover = function() {
//   //     console.log("mouse over");
//   //     // change html content
//   //     y[4].innerHTML = "Hey";
//   //   };
//   // }
// });